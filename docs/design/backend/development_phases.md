# WealthLite 开发阶段规划

## 概述

WealthLite项目采用分阶段迭代开发模式，每个阶段专注于特定的资产类型和功能模块，确保每个阶段都能交付可用的完整功能。

---

## Phase 1: 核心基础 + 现金与固定收益 ✅

### 开发目标
建立系统核心架构，实现现金及固定收益类资产的完整功能链路。

### 资产类型范围
```python
# 第一阶段支持的资产类型
CASH = "现金及等价物"          # ✅ 已完成
FIXED_INCOME = "固定收益类"    # ✅ 已完成
```

### 具体包含内容

#### 现金及等价物
- **子类型**：
  - 储蓄存款（银行活期、定期存款）
  - 货币基金（余额宝类产品）
  - 短期存款证
  - 现金等价物

- **交易类型**：
  - 存入 (DEPOSIT)
  - 取出 (WITHDRAW) 
  - 利息收入 (INTEREST)
  - 转入 (TRANSFER_IN)
  - 转出 (TRANSFER_OUT)

- **特殊属性**：
  - 利率 (interest_rate)
  - 账户类型 (account_type)
  - 极高流动性、极低风险

#### 固定收益类
- **子类型**：
  - 政府债券（国债、地方债）
  - 企业债券（公司债、可转债）
  - 银行理财产品
  - 定期存款

- **交易类型**：
  - 买入 (BUY)
  - 卖出 (SELL)
  - 利息收入 (INTEREST)
  - 到期赎回

- **特殊属性**：
  - 年化收益率 (annual_rate)
  - 到期日 (maturity_date)
  - 面值 (face_value)
  - 利息类型 (interest_type)
  - 付息频率 (payment_frequency)

### 核心功能实现
- ✅ 数据模型层：Asset, Transaction, Position, Portfolio
- ✅ 枚举定义：完整的枚举体系
- ✅ 序列化支持：JSON序列化和反序列化
- ✅ 业务逻辑：持仓计算、组合分析、快照功能
- ✅ 测试框架：单元测试、测试数据工厂

### 技术架构
- ✅ 交易驱动架构：严格遵循"只有交易能产生持仓"
- ✅ 多货币支持：Currency枚举和汇率转换
- ✅ 扩展性设计：支持自定义属性和未来扩展

---

## Phase 2: 权益类资产 🔄

### 开发目标
在Phase 1基础上，增加权益类资产支持，实现股票、基金等投资品种。

### 资产类型范围
```python
EQUITY = "权益类"              # 🔄 待实现
```

### 具体包含内容

#### 权益类资产
- **子类型**：
  - A股股票
  - 港股股票
  - 美股股票
  - ETF基金
  - 主动管理基金
  - 指数基金

- **交易类型**：
  - 买入 (BUY)
  - 卖出 (SELL)
  - 分红收入 (DIVIDEND)
  - 股票分割
  - 配股配息

- **特殊属性**：
  - 股票代码 (symbol)
  - 交易所 (exchange)
  - 股数 (quantity)
  - 每股价格 (price_per_share)
  - 交易佣金 (commission)
  - 分红金额 (dividend_amount)

### 新增功能
- 🔄 股票价格管理
- 🔄 分红再投资
- 🔄 成本均价计算
- 🔄 持仓数量管理
- 🔄 交易费用计算

---

## Phase 3: 不动产投资 🔄

### 开发目标
支持房产投资管理，包括住宅、商业地产等不动产投资。

### 资产类型范围
```python
REAL_ESTATE = "不动产"         # 🔄 待实现
```

### 具体包含内容

#### 不动产
- **子类型**：
  - 住宅房产
  - 商业地产
  - 工业地产
  - 土地使用权
  - REITs（房地产投资信托）

- **交易类型**：
  - 买入 (BUY)
  - 卖出 (SELL)
  - 租金收入 (RENTAL_INCOME)
  - 维护费用 (MAINTENANCE_FEE)
  - 税费 (TAX_FEE)

- **特殊属性**：
  - 房产面积 (property_area)
  - 单价 (price_per_unit)
  - 房产类型 (property_type)
  - 地理位置 (location)
  - 税费金额 (tax_amount)
  - 租金收益率

### 新增功能
- 🔄 房产估值管理
- 🔄 租金收益计算
- 🔄 税费管理
- 🔄 维护成本跟踪

---

## Phase 4: 大宗商品 🔄

### 开发目标
支持贵金属、能源、农产品等大宗商品投资。

### 资产类型范围
```python
COMMODITY = "大宗商品"         # 🔄 待实现
```

### 具体包含内容

#### 大宗商品
- **子类型**：
  - 贵金属（黄金、白银、铂金）
  - 能源（原油、天然气）
  - 农产品（大豆、玉米、小麦）
  - 工业金属（铜、铝、锌）

- **交易类型**：
  - 买入 (BUY)
  - 卖出 (SELL)
  - 仓储费用 (STORAGE_FEE)
  - 交割费用 (DELIVERY_FEE)

- **特殊属性**：
  - 商品类型 (commodity_type)
  - 交易单位 (trading_unit)
  - 仓储位置 (storage_location)
  - 品质等级 (quality_grade)

---

## Phase 5: 高级功能 🔄

### 开发目标
实现高级分析功能、UI界面、数据导入导出等完整功能。

### 功能模块
- 🔄 Web UI界面
- 🔄 数据可视化
- 🔄 业绩分析报告
- 🔄 风险评估
- 🔄 资产配置建议
- 🔄 数据导入导出
- 🔄 自动化报表
- 🔄 多语言支持

---

## 开发原则

### 架构一致性
- 每个阶段都严格遵循交易驱动架构
- 保持数据模型的一致性和扩展性
- 确保向后兼容性

### 质量保证
- 每个阶段都有完整的单元测试
- 功能完整性测试
- 数据一致性验证

### 交付标准
- 每个阶段都能独立运行
- 功能完整，无明显缺陷
- 文档齐全，便于维护

---

## 当前状态

**Phase 1状态**: ✅ **已完成**
- 核心数据模型实现完毕
- 现金和固定收益功能完整
- 测试框架建立完成
- 数据持久化层完善
- 外币资产处理方案验证
- 设计文档完善

**当前开发重点**: Phase 1 外币资产处理 ✅ **已完成**
- ✅ 简化测试结构，专注于现金和固定收益两种资产类型
- ✅ 创建Phase 1专用的单元测试和集成测试
- ✅ 建立针对小型应用的精简测试策略
- ✅ 更新开发阶段文档，明确Phase 1范围
- ✅ 完成22个单元测试，覆盖核心功能，全部通过
- ✅ 完成8个集成测试，验证数据持久化流程
- ✅ 完成外币资产处理方案设计和验证

**Phase 1 测试成果**:
- **单元测试**: 22个测试 - 资产、交易、持仓、投资组合、快照模型
- **集成测试**: 8个测试 - 数据持久化、银行理财产品、错误处理、性能验证
- **外币测试**: 4个测试 - 港元定存、多币种组合、汇率波动影响
- **总测试数**: 34个测试，全部通过

**Phase 1 外币资产处理成果**:
- **设计方案**: 简化方案，不单独记录外汇兑换，直接在存取款中体现
- **技术实现**: Position模型支持双币种计算（原币种+基础货币）
- **场景验证**: 港元定存到期后两种处理方式（保持港币/转回人民币）
- **文档完善**: 创建外币资产处理设计方案文档

**下一步计划**: 
1. ✅ 完善Phase 1的单元测试（仅现金和固定收益）
2. ✅ Phase 1功能验证和集成测试（仅现金和固定收益）
3. ✅ Phase 1建立数据持久化层（SQLite + JSON）（仅现金和固定收益）
4. ✅ Phase 1外币资产处理方案验证
5. 🔄 Phase 1的UI开发（仅现金和固定收益）
6. 🔄 准备Phase 2的权益类资产开发


**开发策略调整**:
- **小型应用定位**: 去除性能测试和慢速测试，专注核心功能
- **阶段性开发**: 严格按Phase划分，每个Phase完整交付
- **测试策略**: 内存数据库 + 临时文件数据库的混合测试方案

---

*最后更新时间：2025-06-21 17:39:34* 