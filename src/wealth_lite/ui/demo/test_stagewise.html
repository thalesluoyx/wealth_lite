<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stagewise å·¥å…·æ æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
        }
        .button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        #status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
    
    <!-- Stagewise Toolbar Integration (Development Only) -->
    <script>
        // æ£€æµ‹æ˜¯å¦ä¸ºå¼€å‘ç¯å¢ƒï¼ˆæœ¬åœ°æœåŠ¡å™¨ï¼‰
        const isDevelopment = window.location.hostname === 'localhost' || 
                             window.location.hostname === '127.0.0.1' ||
                             window.location.hostname === '';
        
        if (isDevelopment) {
            console.log('ğŸ”§ å¼€å‘ç¯å¢ƒæ£€æµ‹åˆ°ï¼Œæ­£åœ¨åŠ è½½ stagewise å·¥å…·æ ...');
            
            // åˆ›å»ºç®€åŒ–ç‰ˆçš„ stagewise æ›¿ä»£æ–¹æ¡ˆ
            console.log('ğŸ”§ å¼€å‘ç¯å¢ƒæ£€æµ‹åˆ°ï¼Œæ­£åœ¨åˆå§‹åŒ– Stagewise æ›¿ä»£å·¥å…·æ ...');
            
            // åˆ›å»ºç®€åŒ–ç‰ˆå·¥å…·æ 
            function createSimplifiedStagewise() {
                console.log('ğŸ“¦ åˆ›å»ºç®€åŒ–ç‰ˆ Stagewise å·¥å…·æ ');
                
                // åˆ›å»ºå·¥å…·æ å®¹å™¨
                const toolbar = document.createElement('div');
                toolbar.id = 'simplified-stagewise-toolbar';
                toolbar.style.cssText = `
                    position: fixed;
                    top: 10px;
                    right: 10px;
                    background: #2d3748;
                    color: white;
                    padding: 15px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    z-index: 10000;
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                    font-size: 14px;
                    max-width: 300px;
                    display: none;
                `;
                
                toolbar.innerHTML = `
                    <div style="margin-bottom: 10px; font-weight: bold; color: #4fd1c7;">
                        ğŸ¯ å…ƒç´ é€‰æ‹©å™¨
                    </div>
                    <div id="selected-element-info" style="margin-bottom: 10px; padding: 8px; background: #1a202c; border-radius: 4px; font-size: 12px;">
                        ç‚¹å‡»é¡µé¢å…ƒç´ æ¥é€‰æ‹©
                    </div>
                    <textarea id="stagewise-comment" placeholder="æè¿°æ‚¨æƒ³è¦çš„ä¿®æ”¹..." 
                        style="width: 100%; height: 60px; margin-bottom: 10px; padding: 8px; border: none; border-radius: 4px; resize: vertical; font-size: 12px;"></textarea>
                    <div style="display: flex; gap: 8px;">
                        <button id="send-to-ai" style="flex: 1; padding: 8px; background: #4fd1c7; color: #1a202c; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">
                            å‘é€ç»™ AI
                        </button>
                        <button id="close-toolbar" style="padding: 8px; background: #e53e3e; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            âœ•
                        </button>
                    </div>
                `;
                
                document.body.appendChild(toolbar);
                
                // æ·»åŠ å…ƒç´ é€‰æ‹©åŠŸèƒ½
                let selectedElement = null;
                let isSelecting = false;
                
                // é«˜äº®æ ·å¼
                const highlightStyle = document.createElement('style');
                highlightStyle.textContent = `
                    .stagewise-highlight {
                        outline: 3px solid #4fd1c7 !important;
                        outline-offset: 2px !important;
                        cursor: pointer !important;
                    }
                    .stagewise-selected {
                        outline: 3px solid #f56565 !important;
                        outline-offset: 2px !important;
                    }
                `;
                document.head.appendChild(highlightStyle);
                
                // å…ƒç´ é€‰æ‹©é€»è¾‘
                function startElementSelection() {
                    isSelecting = true;
                    document.body.style.cursor = 'crosshair';
                    
                    // é¼ æ ‡æ‚¬åœé«˜äº®
                    document.addEventListener('mouseover', onMouseOver);
                    document.addEventListener('mouseout', onMouseOut);
                    document.addEventListener('click', onElementClick);
                }
                
                function onMouseOver(e) {
                    if (!isSelecting || e.target.closest('#simplified-stagewise-toolbar')) return;
                    e.target.classList.add('stagewise-highlight');
                }
                
                function onMouseOut(e) {
                    if (!isSelecting) return;
                    e.target.classList.remove('stagewise-highlight');
                }
                
                function onElementClick(e) {
                    if (!isSelecting || e.target.closest('#simplified-stagewise-toolbar')) return;
                    
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // æ¸…é™¤ä¹‹å‰é€‰æ‹©
                    if (selectedElement) {
                        selectedElement.classList.remove('stagewise-selected');
                    }
                    
                    // é€‰æ‹©æ–°å…ƒç´ 
                    selectedElement = e.target;
                    selectedElement.classList.add('stagewise-selected');
                    selectedElement.classList.remove('stagewise-highlight');
                    
                    // åœæ­¢é€‰æ‹©æ¨¡å¼
                    isSelecting = false;
                    document.body.style.cursor = 'default';
                    document.removeEventListener('mouseover', onMouseOver);
                    document.removeEventListener('mouseout', onMouseOut);
                    document.removeEventListener('click', onElementClick);
                    
                    // æ›´æ–°å·¥å…·æ ä¿¡æ¯
                    const elementInfo = `${selectedElement.tagName.toLowerCase()}${selectedElement.className ? '.' + selectedElement.className.split(' ').join('.') : ''}${selectedElement.id ? '#' + selectedElement.id : ''}`;
                    document.getElementById('selected-element-info').textContent = `å·²é€‰æ‹©: ${elementInfo}`;
                    
                    // æ˜¾ç¤ºå·¥å…·æ 
                    toolbar.style.display = 'block';
                }
                
                // å·¥å…·æ æŒ‰é’®äº‹ä»¶
                document.getElementById('send-to-ai').addEventListener('click', () => {
                    const comment = document.getElementById('stagewise-comment').value;
                    if (!selectedElement || !comment.trim()) {
                        alert('è¯·å…ˆé€‰æ‹©å…ƒç´ å¹¶æ·»åŠ ä¿®æ”¹è¯´æ˜');
                        return;
                    }
                    
                    // ç”Ÿæˆè¯¦ç»†çš„å…ƒç´ ä¿¡æ¯
                    const elementInfo = {
                        tagName: selectedElement.tagName,
                        className: selectedElement.className,
                        id: selectedElement.id,
                        textContent: selectedElement.textContent?.substring(0, 100),
                        outerHTML: selectedElement.outerHTML?.substring(0, 200)
                    };
                    
                    // æ¨¡æ‹Ÿå‘é€åˆ° AIï¼ˆå®é™…åº”ç”¨ä¸­ä¼šé€šè¿‡ VS Code æ‰©å±•å‘é€ï¼‰
                    console.log('ğŸ¤– å‘é€ç»™ AI çš„è¯·æ±‚:', {
                        element: elementInfo,
                        comment: comment,
                        timestamp: new Date().toISOString()
                    });
                    
                    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                    alert(`å·²å‘é€ä¿®æ”¹è¯·æ±‚ï¼š\n\nå…ƒç´ : ${elementInfo.tagName}\nè¯´æ˜: ${comment}\n\næ³¨æ„ï¼šåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œè¿™ä¼šé€šè¿‡ VS Code æ‰©å±•å‘é€ç»™ AI åŠ©æ‰‹ã€‚`);
                    
                    // æ¸…ç†
                    document.getElementById('stagewise-comment').value = '';
                    toolbar.style.display = 'none';
                    if (selectedElement) {
                        selectedElement.classList.remove('stagewise-selected');
                        selectedElement = null;
                    }
                });
                
                document.getElementById('close-toolbar').addEventListener('click', () => {
                    toolbar.style.display = 'none';
                    if (selectedElement) {
                        selectedElement.classList.remove('stagewise-selected');
                        selectedElement = null;
                    }
                });
                
                // å¯åŠ¨å…ƒç´ é€‰æ‹©
                startElementSelection();
                
                return toolbar;
            }
            
            // åˆå§‹åŒ–ç®€åŒ–ç‰ˆå·¥å…·æ 
            try {
                createSimplifiedStagewise();
                console.log('âœ… ç®€åŒ–ç‰ˆ Stagewise å·¥å…·æ åˆå§‹åŒ–æˆåŠŸ');
                updateStatus('success', 'âœ… ç®€åŒ–ç‰ˆ Stagewise å·¥å…·æ å·²åŠ è½½ï¼ç°åœ¨å¯ä»¥ç‚¹å‡»é¡µé¢å…ƒç´ æ¥é€‰æ‹©');
            } catch (error) {
                console.error('âŒ ç®€åŒ–ç‰ˆå·¥å…·æ åˆå§‹åŒ–å¤±è´¥:', error);
                updateStatus('error', 'âŒ å·¥å…·æ åˆå§‹åŒ–å¤±è´¥: ' + error.message);
            }
        } else {
            updateStatus('error', 'âš ï¸ éå¼€å‘ç¯å¢ƒï¼ŒStagewise å·¥å…·æ æœªåŠ è½½');
        }
        
        function updateStatus(type, message) {
            const statusEl = document.getElementById('status');
            if (statusEl) {
                statusEl.className = type;
                statusEl.textContent = message;
            }
        }
    </script>
</head>
<body>
    <h1>ğŸ§ª Stagewise å·¥å…·æ æµ‹è¯•é¡µé¢</h1>
    
    <div id="status">â³ æ­£åœ¨æ£€æµ‹ Stagewise å·¥å…·æ ...</div>
    
    <div class="test-section">
        <h2>å¦‚ä½•ä½¿ç”¨ Stagewiseï¼š</h2>
        <ol>
            <li><strong>é€‰æ‹©å…ƒç´ </strong>ï¼šç‚¹å‡»é¡µé¢ä¸Šçš„ä»»ä½•å…ƒç´ ï¼ˆæŒ‰é’®ã€å¡ç‰‡ç­‰ï¼‰</li>
            <li><strong>æŸ¥çœ‹å·¥å…·æ </strong>ï¼šåº”è¯¥ä¼šçœ‹åˆ° Stagewise å·¥å…·æ å‡ºç°</li>
            <li><strong>æ·»åŠ æ³¨é‡Š</strong>ï¼šåœ¨å·¥å…·æ ä¸­æè¿°æ‚¨æƒ³è¦çš„ä¿®æ”¹</li>
            <li><strong>å‘é€ç»™ AI</strong>ï¼šè®© AI ç›´æ¥åœ¨ä»£ç ä¸­è¿›è¡Œä¿®æ”¹</li>
        </ol>
    </div>
    
    <div class="test-section">
        <h3>æµ‹è¯•å…ƒç´  - è¯·å°è¯•ç‚¹å‡»è¿™äº›ï¼š</h3>
        
        <button class="button" onclick="alert('æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼')">
            ğŸ”˜ æµ‹è¯•æŒ‰é’® 1
        </button>
        
        <button class="button" style="background: #28a745;" onclick="alert('ç»¿è‰²æŒ‰é’®ï¼')">
            ğŸŸ¢ æµ‹è¯•æŒ‰é’® 2
        </button>
        
        <div class="card">
            <h4>ğŸ“‹ æµ‹è¯•å¡ç‰‡</h4>
            <p>è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å¡ç‰‡ï¼Œæ‚¨å¯ä»¥ç‚¹å‡»å®ƒæ¥é€‰æ‹©ã€‚å°è¯•å‘Šè¯‰ AI ä¿®æ”¹è¿™ä¸ªå¡ç‰‡çš„æ ·å¼æˆ–å†…å®¹ã€‚</p>
        </div>
        
        <div class="card" style="background: #e3f2fd;">
            <h4>ğŸ¨ å¦ä¸€ä¸ªå¡ç‰‡</h4>
            <p>è¿™ä¸ªå¡ç‰‡æœ‰ä¸åŒçš„èƒŒæ™¯è‰²ã€‚æ‚¨å¯ä»¥è¦æ±‚ AI ä¿®æ”¹é¢œè‰²ã€æ·»åŠ è¾¹æ¡†æˆ–æ”¹å˜å¸ƒå±€ã€‚</p>
        </div>
    </div>
    
    <div class="test-section">
        <h3>ğŸ’¡ ä½¿ç”¨æç¤ºï¼š</h3>
        <ul>
            <li>ç¡®ä¿æ‚¨å·²å®‰è£… "Stagewise VSCode Extension"</li>
            <li>åœ¨ VS Code ä¸­æ‰“å¼€æ­¤é¡¹ç›®</li>
            <li>å·¥å…·æ åªåœ¨å¼€å‘ç¯å¢ƒï¼ˆlocalhostï¼‰ä¸­æ˜¾ç¤º</li>
            <li>é€‰ä¸­å…ƒç´ åï¼Œå·¥å…·æ ä¼šæä¾›ç¼–è¾‘é€‰é¡¹</li>
        </ul>
    </div>
</body>
</html> 